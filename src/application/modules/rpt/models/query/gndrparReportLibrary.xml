<?xml version="1.0"?>

  <querylibrary>
   <query id="gndrPar">
     <title>Gender Par Reports</title>
     <result>
		<externalTableFormat>y</externalTableFormat>
         <tableheader>
			 <label>Gender</label>
			  <label>Days Outstanding</label>
			 <label>Total Beneficiary</label>
             <label>Total Loan</label>
			 <label>Principal</label>
			 <label>Due</label>
         </tableheader>

         <queryheader>
             <item>GENDER</item>
			  <item>DAYS</item>
             <item>TOTAL_CUSTOMER</item>
             <item>LOAN</item>
			 <item>PRINCIPAL</item>
			 <item>DUE</item>
         </queryheader>

         <sqlcontent>
            SELECT IF(ent.SEX = 'M',ent.SEX,'F' ) AS GENDER , '0-30' AS DAYS , COUNT(smry.CUSTOMER_ID) AS TOTAL_CUSTOMER,
			SUM(TOTAL_PAYMENT_PRINCIPAL) AS LOAN, SUM(TOTAL_RECEIPT_PRINCIPAL) AS PRINCIPAL,
			SUM(TOTAL_RECEIPT_DUE_PRINCIPAL) AS DUE
			FROM ltr_trn_summary as smry, ref_mst_entity as ent
			WHERE DATEDIFF(CURDATE(),START_DATE) @GREATEREQUAL@ 30 AND DATEDIFF(CURDATE(),START_DATE) @LESSEQUAL@ 60
			AND smry.STATUS='NORMAL' AND ent.ENTITY_ID=smry.CUSTOMER_ID
			GROUP BY GENDER, DAYS
			UNION
			SELECT IF(ent.SEX = 'M',ent.SEX,'F' ) AS GENDER , '61-90' AS DAYS , COUNT(smry.CUSTOMER_ID) AS TOTAL_CUSTOMER,
			SUM(TOTAL_PAYMENT_PRINCIPAL) AS LOAN, SUM(TOTAL_RECEIPT_PRINCIPAL) AS PRINCIPAL,
			SUM(TOTAL_RECEIPT_DUE_PRINCIPAL) AS DUE
			FROM ltr_trn_summary as smry, ref_mst_entity as ent
			WHERE DATEDIFF(CURDATE(),START_DATE) @GREATEREQUAL@ 61 AND DATEDIFF(CURDATE(),START_DATE) @LESSEQUAL@ 90
			AND smry.STATUS='NORMAL' AND ent.ENTITY_ID=smry.CUSTOMER_ID
			GROUP BY GENDER, DAYS
			UNION
			SELECT IF(ent.SEX = 'M',ent.SEX,'F' ) AS GENDER , '91-120' AS DAYS , COUNT(smry.CUSTOMER_ID) AS TOTAL_CUSTOMER,
			SUM(TOTAL_PAYMENT_PRINCIPAL) AS LOAN, SUM(TOTAL_RECEIPT_PRINCIPAL) AS PRINCIPAL,
			SUM(TOTAL_RECEIPT_DUE_PRINCIPAL) AS DUE
			FROM ltr_trn_summary as smry, ref_mst_entity as ent
			WHERE DATEDIFF(CURDATE(),START_DATE) @GREATEREQUAL@ 91 AND DATEDIFF(CURDATE(),START_DATE) @LESSEQUAL@ 120
			AND smry.STATUS='NORMAL' AND ent.ENTITY_ID=smry.CUSTOMER_ID
			GROUP BY GENDER, DAYS
			UNION
			SELECT IF(ent.SEX = 'M',ent.SEX,'F' ) AS GENDER , '121-150' AS DAYS , COUNT(smry.CUSTOMER_ID) AS TOTAL_CUSTOMER,
			SUM(TOTAL_PAYMENT_PRINCIPAL) AS LOAN, SUM(TOTAL_RECEIPT_PRINCIPAL) AS PRINCIPAL,
			SUM(TOTAL_RECEIPT_DUE_PRINCIPAL) AS DUE
			FROM ltr_trn_summary as smry, ref_mst_entity as ent
			WHERE DATEDIFF(CURDATE(),START_DATE) @GREATEREQUAL@ 121 AND DATEDIFF(CURDATE(),START_DATE) @LESSEQUAL@ 150
			AND smry.STATUS='NORMAL' AND ent.ENTITY_ID=smry.CUSTOMER_ID
			GROUP BY GENDER, DAYS
			UNION
			SELECT IF(ent.SEX = 'M',ent.SEX,'F' ) AS GENDER , '151-180' AS DAYS , COUNT(smry.CUSTOMER_ID) AS TOTAL_CUSTOMER,
			SUM(TOTAL_PAYMENT_PRINCIPAL) AS LOAN, SUM(TOTAL_RECEIPT_PRINCIPAL) AS PRINCIPAL,
			SUM(TOTAL_RECEIPT_DUE_PRINCIPAL) AS DUE
			FROM ltr_trn_summary as smry, ref_mst_entity as ent
			WHERE DATEDIFF(CURDATE(),START_DATE) @GREATEREQUAL@ 151 AND DATEDIFF(CURDATE(),START_DATE) @LESSEQUAL@ 180
			AND smry.STATUS='NORMAL' AND ent.ENTITY_ID=smry.CUSTOMER_ID
			GROUP BY GENDER, DAYS
			UNION
			SELECT IF(ent.SEX = 'M',ent.SEX,'F' ) AS GENDER , '181-360' AS DAYS , COUNT(smry.CUSTOMER_ID) AS TOTAL_CUSTOMER,
			SUM(TOTAL_PAYMENT_PRINCIPAL) AS LOAN, SUM(TOTAL_RECEIPT_PRINCIPAL) AS PRINCIPAL,
			SUM(TOTAL_RECEIPT_DUE_PRINCIPAL) AS DUE
			FROM ltr_trn_summary as smry, ref_mst_entity as ent
			WHERE DATEDIFF(CURDATE(),START_DATE) @GREATEREQUAL@ 181 AND DATEDIFF(CURDATE(),START_DATE) @LESSEQUAL@ 360
			AND smry.STATUS='NORMAL' AND ent.ENTITY_ID=smry.CUSTOMER_ID
			GROUP BY GENDER, DAYS
			UNION
			SELECT IF(ent.SEX = 'M',ent.SEX,'F' ) AS GENDER , '360 >' AS DAYS , COUNT(smry.CUSTOMER_ID) AS TOTAL_CUSTOMER,
			SUM(TOTAL_PAYMENT_PRINCIPAL) AS LOAN, SUM(TOTAL_RECEIPT_PRINCIPAL) AS PRINCIPAL,
			SUM(TOTAL_RECEIPT_DUE_PRINCIPAL) AS DUE
			FROM ltr_trn_summary as smry, ref_mst_entity as ent
			WHERE DATEDIFF(CURDATE(),START_DATE) @GREATER@ 360 AND DATEDIFF(CURDATE(),START_DATE) @LESSEQUAL@ 180
			AND smry.STATUS='NORMAL' AND ent.ENTITY_ID=smry.CUSTOMER_ID
			GROUP BY GENDER, DAYS

         </sqlcontent>
         
         <patinatorconditions>
            <pages>20</pages>
            <rowsperpage>20</rowsperpage>
         </patinatorconditions>

     </result>

     <criteria>
         <searchparams>  
            
           <searchitem>
                 <searchparam>Y</searchparam>
                 <name>gender</name>
                 <columnvalue>GENDER</columnvalue>
				 <conditiontype>@EQUAL@</conditiontype>
                 <label>Gender</label>
                 <isdisplay>Y</isdisplay>
                 <order>1</order>
                 <datatype>CHAR</datatype>
                 <displaytype>RADIO</displaytype>
				 <sqlbundle>
					<sqlcontent>
						SELECT VALUE_ID,VALUE_NAME FROM ref_sta_key_value
						WHERE KEY_ID ='Gender'
					</sqlcontent>
					<label>VALUE_NAME</label>
					<value>VALUE_ID</value>
				 </sqlbundle>
             </searchitem>
      
	          <searchitem>
                 <searchparam>Y</searchparam>
                 <name>days</name>
                 <columnvalue>DAYS</columnvalue>
				  <conditiontype>@LIKE@</conditiontype>
                 <label>Days Outstanding</label>
                 <isdisplay>Y</isdisplay>
                 <order>2</order>
                 <datatype>CHAR</datatype>
                 <displaytype>DROPDOWN</displaytype>
				 <values>
					<label>ALL</label>
					<value>%</value>

					<label>30-60</label>
					<value>30-60</value>

					<label>61-90</label>
					<value>61-90</value>

					<label>91-120</label>
					<value>91-120</value>

					<label>121-150</label>
					<value>121-150</value>

					<label>151-180</label>
					<value>151-180</value>

					<label>181-360</label>
					<value>181-360</value>

					<label>360-above</label>
					<value>360 ></value>
				</values>
         </searchitem>

			 <searchitem>
                 <isdisplay>Y</isdisplay>
                 <order>3</order>
                 <displaytype>BLANK</displaytype>
             </searchitem>

             <searchitem>
                 <name>Search</name>
                 <isdisplay>Y</isdisplay>
                 <order>4</order>
                 <id>submit</id>
                 <datatype>CHAR</datatype>
                 <displaytype>SUBMIT</displaytype>
                 <value>Search</value>
             </searchitem>

        </searchparams>
     </criteria>

   </query>
   </querylibrary> 


